LoadModule security2_module /usr/local/apache2/modules/mod_security2.so

Timeout 60
LogLevel warn
ErrorLog /var/log/apache2/error.log

# https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-(v2.x)#secserversignature
SecServerSignature Apache

<IfModule reqtimeout_module>
  RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
</IfModule>

# The "common" and "combined" formats are predefined
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" modsec
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" metricslog
ErrorLogFormat "[%{u}t] [%-m:%l] [pid %P:tid %T] %7F: %E: [client\ %a] %M% ,\ referer\ %{Referer}i"

CustomLog /dev/null metricslog "env=!nologging"

Include /etc/modsecurity.d/modsecurity.conf
Include /etc/modsecurity.d/setup.conf
