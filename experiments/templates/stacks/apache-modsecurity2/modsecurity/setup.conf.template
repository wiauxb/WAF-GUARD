# ============================================================================
# ModSecurity Master Setup - Complete Configuration
# ============================================================================
# This file includes ALL apps and rules for comprehensive parsing/analysis.
# In production, each VHost uses its specific setup file.
#
# Generated by WAF-Guard on ${GENERATION_DATE}
# ============================================================================
# Active Apps: ${ALL_APPS_LIST}
# Active VHosts: ${ALL_VHOSTS_LIST}
# ============================================================================

# === Step 1: CRS Setup ===
Include /etc/modsecurity.d/crs-setup.conf

# === Step 2: Global Exclusions BEFORE CRS ===
IncludeOptional /etc/modsecurity.d/custom/crs/before-crs.conf

# === Step 3: All App-Specific Exclusions BEFORE CRS ===
IncludeOptional /etc/modsecurity.d/apps/*/*-before.conf
IncludeOptional /etc/modsecurity.d/custom/apps/*/*-before.conf

# === Step 4: OWASP CRS Rules ===
IncludeOptional /etc/modsecurity.d/crs_rules/*.conf

# === Step 5: Global Exclusions AFTER CRS ===
IncludeOptional /etc/modsecurity.d/custom/crs/after-crs.conf

# === Step 6: All App-Specific Exclusions AFTER CRS ===
IncludeOptional /etc/modsecurity.d/apps/*/*-after.conf
IncludeOptional /etc/modsecurity.d/custom/apps/*/*-after.conf

# === Step 7: All App-Specific Configuration ===
IncludeOptional /etc/modsecurity.d/apps/*/*-config.conf

# ============================================================================
# End of Master Setup
# ============================================================================