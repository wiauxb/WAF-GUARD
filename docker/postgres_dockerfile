FROM postgres:latest

# Create the data directory with correct permissions
RUN mkdir -p /var/lib/postgresql/data && \
    chown -R postgres:postgres /var/lib/postgresql/data

# Copy SQL files for database initialization
COPY scripts/cwaf_db.sql /init/
COPY scripts/files_db.sql /init/
COPY scripts/chatbot_db.sql /init/

# Copy initialization script
COPY scripts/init-databases.sh /docker-entrypoint-initdb.d/

# Make the initialization script executable
RUN chmod +x /docker-entrypoint-initdb.d/init-databases.sh

